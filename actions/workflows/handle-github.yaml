version: 1.0

description: Receiver for github webhooks

input:
  - trigger_data

tasks:
  route:
    action: core.noop
    next:
      - when: <% succeeded() and ctx().trigger_data.containsKey("commits") and ctx().trigger_data.commits.len() %>
        do: handle_commit


  handle_commit:
    action: packs.install
    input:
      packs:
        - "<% ctx().trigger_data.repository.url %>"
